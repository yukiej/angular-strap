{"version":3,"sources":["modules/modal.js"],"names":["angular","placement","provider","templateUrl","this","defaults","template","contentTemplate","container","element","backdrop","keyboard","html","show","size","zIndex","$get","forEach","requestAnimationFrame","bodyElement","backdropCount","dialogBaseZindex","validSizes","ModalFactory","config","enterAnimateCallback","$modal","hide","options","prefixEvent","$isShown","onShow","isFunction","$emit","modalElement","attr","isDefined","scope","onHide","removeClass","prefixClass","findFocusableElements","focusable","offsetWidth","offsetHeight","focusableElements","document","findNextFocusableElement","activeElement","filter","call","querySelectorAll","inReverse","index","undefined","toggle","prototype","reverse","indexOf","unbindBackdropEvents","off","hideOnBackdropClick","backdropElement","preventEventDefault","bindKeyboardEvents","on","$onKeyDown","evt","focus","preventDefault","modalScope","$destroy","$element","parseInt","backdropBaseZindex","compile","$scope","$new","$rootScope","id","returnFocus","key","$show","$sce","trustAsHtml","$$postDigest","left","bottom","right","promise","css","compileData","init","data","destroy","destroyModalElement","parent","after","isElement","z-index","link","clonedElement","onBeforeShow","display","defaultPrevented","addClass","customClass","animation","findElement","$animate","enter","minor","backdropAnimation","el","then","safeDigest","bindBackdropEvents","onBeforeHide","leave","leaveAnimateCallback","unbindKeyboardEvents","which","keyCode","nextFocusable","stopPropagation","shiftKey","length","directive","$root","$$phase","$digest","restrict","query","lg","sm","$window","setTimeout","body","$options","falseValueRegExp","test","bsKey","modalClass","$observe","charAt","newValue","oldValue","$eval","$watch","isObject","extend","bsModal","modal","content","trigger","$on"],"mappings":"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","file":"modal.min.js","sourcesContent":["'use strict';\n\nangular.module('mgcrea.ngStrap.modal', ['mgcrea.ngStrap.core', 'mgcrea.ngStrap.helpers.dimensions'])\n\n  .provider('$modal', function () {\n\n    var defaults = this.defaults = {\n      animation: 'am-fade',\n      backdropAnimation: 'am-fade',\n      customClass: '',\n      prefixClass: 'modal',\n      prefixEvent: 'modal',\n      placement: 'top',\n      templateUrl: 'modal/modal.tpl.html',\n      template: '',\n      contentTemplate: false,\n      container: false,\n      element: null,\n      backdrop: true,\n      keyboard: true,\n      html: false,\n      show: true,\n      size: null,\n      zIndex: null\n    };\n\n    this.$get = function ($window, $rootScope, $bsCompiler, $animate, $timeout, $sce, dimensions) {\n\n      var forEach = angular.forEach;\n      var requestAnimationFrame = $window.requestAnimationFrame || $window.setTimeout;\n      var bodyElement = angular.element($window.document.body);\n\n      var backdropCount = 0;\n      var dialogBaseZindex = 1050;\n      var backdropBaseZindex = 1040;\n\n      var validSizes = {\n        lg: 'modal-lg',\n        sm: 'modal-sm'\n      };\n\n      function ModalFactory (config) {\n\n        var $modal = {};\n\n        // Common vars\n        var options = $modal.$options = angular.extend({}, defaults, config);\n        var promise = $modal.$promise = $bsCompiler.compile(options);\n        var scope = $modal.$scope = options.scope && options.scope.$new() || $rootScope.$new();\n\n        if (!options.element && !options.container) {\n          options.container = 'body';\n        }\n\n        if (options.zIndex) {\n          dialogBaseZindex = parseInt(options.zIndex, 10);\n          backdropBaseZindex = dialogBaseZindex - 10;\n        }\n\n        // Store $id to identify the triggering element in events\n        // give priority to options.id, otherwise, try to use\n        // element id if defined\n        $modal.$id = options.id || options.element && options.element.attr('id') || '';\n\n        $modal.returnFocus = function () {\n\n        };\n\n        // Support scope as string options\n        forEach(['title', 'content'], function (key) {\n          if (options[key]) scope[key] = $sce.trustAsHtml(options[key]);\n        });\n\n        // Provide scope helpers\n        scope.$hide = function () {\n          scope.$$postDigest(function () {\n            $modal.hide();\n          });\n        };\n        scope.$show = function () {\n          scope.$$postDigest(function () {\n            $modal.show();\n          });\n        };\n        scope.$toggle = function () {\n          scope.$$postDigest(function () {\n            $modal.toggle();\n          });\n        };\n        // Publish isShown as a protected var on scope\n        $modal.$isShown = scope.$isShown = false;\n\n        // Fetch, compile then initialize modal\n        var compileData;\n        var modalElement;\n        var modalScope;\n        var backdropElement = angular.element('<div class=\"' + options.prefixClass + '-backdrop\"/>');\n        backdropElement.css({position: 'fixed', top: '0px', left: '0px', bottom: '0px', right: '0px'});\n        promise.then(function (data) {\n          compileData = data;\n          $modal.init();\n        });\n\n        $modal.init = function () {\n\n          // Options: show\n          if (options.show) {\n            scope.$$postDigest(function () {\n              $modal.show();\n            });\n          }\n\n        };\n\n        $modal.destroy = function () {\n\n          // Remove element\n          destroyModalElement();\n\n          // remove backdrop element\n          if (backdropElement) {\n            backdropElement.remove();\n            backdropElement = null;\n          }\n\n          // Destroy scope\n          scope.$destroy();\n        };\n\n        $modal.show = function () {\n          if ($modal.$isShown) return;\n\n          var parent;\n          var after;\n          if (angular.isElement(options.container)) {\n            parent = options.container;\n            after = options.container[0].lastChild ? angular.element(options.container[0].lastChild) : null;\n          } else {\n            if (options.container) {\n              parent = findElement(options.container);\n              after = parent[0] && parent[0].lastChild ? angular.element(parent[0].lastChild) : null;\n            } else {\n              parent = null;\n              after = options.element;\n            }\n          }\n\n          // destroy any existing modal elements\n          if (modalElement) destroyModalElement();\n\n          // create a new scope, so we can destroy it and all child scopes\n          // when destroying the modal element\n          modalScope = $modal.$scope.$new();\n          // Fetch a cloned element linked from template (noop callback is required)\n          modalElement = $modal.$element = compileData.link(modalScope, function (clonedElement, scope) {});\n\n          if (options.backdrop) {\n            // set z-index\n            modalElement.css({'z-index': dialogBaseZindex + (backdropCount * 20)});\n            backdropElement.css({'z-index': backdropBaseZindex + (backdropCount * 20)});\n\n            // increment number of backdrops\n            backdropCount++;\n          }\n\n          if (scope.$emit(options.prefixEvent + '.show.before', $modal).defaultPrevented) {\n            return;\n          }\n          if (angular.isDefined(options.onBeforeShow) && angular.isFunction(options.onBeforeShow)) {\n            options.onBeforeShow($modal);\n          }\n\n          // Set the initial positioning.\n          modalElement.css({display: 'block'}).addClass(options.placement);\n\n          // Options: customClass\n          if (options.customClass) {\n            modalElement.addClass(options.customClass);\n          }\n\n          // Options: size\n          if (options.size && validSizes[options.size]) {\n            angular.element(findElement('.modal-dialog', modalElement[0])).addClass(validSizes[options.size]);\n          }\n\n          // Options: animation\n          if (options.animation) {\n            if (options.backdrop) {\n              backdropElement.addClass(options.backdropAnimation);\n            }\n            modalElement.addClass(options.animation);\n          }\n\n          if (options.backdrop) {\n            $animate.enter(backdropElement, bodyElement, null);\n          }\n\n          // Support v1.2+ $animate\n          // https://github.com/angular/angular.js/issues/11713\n          if (angular.version.minor <= 2) {\n            $animate.enter(modalElement, parent, after, enterAnimateCallback);\n          } else {\n            $animate.enter(modalElement, parent, after).then(enterAnimateCallback);\n          }\n\n          $modal.$isShown = scope.$isShown = true;\n          safeDigest(scope);\n          // Focus once the enter-animation has started\n          // Weird PhantomJS bug hack\n          var el = modalElement[0];\n          requestAnimationFrame(function () {\n            el.focus();\n          });\n\n          bodyElement.addClass(options.prefixClass + '-open');\n          // Add assistive attributes to the body to prevent the screen reader from reading it with the virtual keys\n          // Only do this if the backdrop option is set.\n          if (options.backdrop) {\n            bodyElement.attr('aria-hidden', 'true');\n          }\n\n          if (options.animation) {\n            bodyElement.addClass(options.prefixClass + '-with-' + options.animation);\n          }\n\n          // Bind events\n          bindBackdropEvents();\n          bindKeyboardEvents();\n          $modal.focus();\n        };\n\n        function enterAnimateCallback () {\n          scope.$emit(options.prefixEvent + '.show', $modal);\n          if (angular.isDefined(options.onShow) && angular.isFunction(options.onShow)) {\n            options.onShow($modal);\n          }\n\n          modalElement.attr('aria-hidden', 'false');\n          modalElement[0].focus();\n        }\n\n        $modal.hide = function () {\n          if (!$modal.$isShown) return;\n\n          if (scope.$emit(options.prefixEvent + '.hide.before', $modal).defaultPrevented) {\n            return;\n          }\n          if (angular.isDefined(options.onBeforeHide) && angular.isFunction(options.onBeforeHide)) {\n            options.onBeforeHide($modal);\n          }\n\n          modalElement.attr('aria-hidden', 'true');\n\n          if ($modal.returnFocus && typeof $modal.returnFocus === 'function') $modal.returnFocus();\n\n          // Support v1.2+ $animate\n          // https://github.com/angular/angular.js/issues/11713\n          if (angular.version.minor <= 2) {\n            $animate.leave(modalElement, leaveAnimateCallback);\n          } else {\n            $animate.leave(modalElement).then(leaveAnimateCallback);\n          }\n\n          if (options.backdrop) {\n            // decrement number of backdrops\n            backdropCount--;\n            $animate.leave(backdropElement);\n          }\n          $modal.$isShown = scope.$isShown = false;\n          safeDigest(scope);\n\n          // Unbind events\n          unbindBackdropEvents();\n          unbindKeyboardEvents();\n        };\n\n        function leaveAnimateCallback () {\n          scope.$emit(options.prefixEvent + '.hide', $modal);\n          if (angular.isDefined(options.onHide) && angular.isFunction(options.onHide)) {\n            options.onHide($modal);\n          }\n          if (findElement('.modal').length <= 0) {\n            bodyElement.removeClass(options.prefixClass + '-open');\n            if (options.backdrop) {\n              bodyElement.attr('aria-hidden', 'false');\n            }\n          }\n          if (options.animation) {\n            bodyElement.removeClass(options.prefixClass + '-with-' + options.animation);\n          }\n        }\n\n        function findFocusableElements () {\n          // Add all elements we want to include in our selection\n          var focusableElements = 'a:not([disabled]), button:not([disabled]), input[type=text]:not([disabled]), [tabindex]:not([disabled]):not([tabindex=\"-1\"])';\n          if (document.activeElement) {\n            var focusable = Array.prototype.filter.call(modalElement[0].querySelectorAll(focusableElements),\n              function (element) {\n                // Check for visibility while always include the current activeElement\n                return element.offsetWidth > 0 || element.offsetHeight > 0 || element === document.activeElement;\n              });\n\n            return focusable;\n          }\n        }\n\n        function findNextFocusableElement (inReverse) {\n          if (document.activeElement) {\n            var focusable = findFocusableElements();\n            if (focusable === undefined) return;\n            if (inReverse) {\n              focusable = Array.prototype.reverse.call(focusable);\n            }\n\n            var index = focusable.indexOf(document.activeElement);\n            return focusable[index + 1];\n          }\n        }\n\n        $modal.toggle = function () {\n          if ($modal.$isShown) {\n            $modal.hide();\n          } else {\n            $modal.show();\n          }\n        };\n\n        $modal.focus = function () {\n          modalElement[0].focus();\n        };\n\n        // Protected methods\n\n        $modal.$onKeyUp = function (evt) {\n\n          // Escape was pressed on an open modal. Hide it.\n          if (evt.which === 27 && $modal.$isShown) {\n            $modal.hide();\n            evt.stopPropagation();\n          }\n        };\n\n        $modal.$onKeyDown = function (evt) {\n          if (options.keyboard) {\n            if (evt.keyCode === 9) {\n\n              var nextFocusable = findNextFocusableElement(evt.shiftKey);\n              if (nextFocusable === undefined) {\n                if (evt.preventDefault) evt.preventDefault();\n                if (evt.stopPropagation) evt.stopPropagation();\n\n                var focusable = findFocusableElements();\n                if (evt.shiftKey) {\n                  focusable[focusable.length - 1].focus();\n                } else {\n                  focusable[0].focus();\n                }\n              }\n            }\n          }\n        };\n\n        function bindBackdropEvents () {\n          if (options.backdrop) {\n            modalElement.on('click', hideOnBackdropClick);\n            backdropElement.on('click', hideOnBackdropClick);\n            backdropElement.on('wheel', preventEventDefault);\n          }\n        }\n\n        function unbindBackdropEvents () {\n          if (options.backdrop) {\n            modalElement.off('click', hideOnBackdropClick);\n            backdropElement.off('click', hideOnBackdropClick);\n            backdropElement.off('wheel', preventEventDefault);\n          }\n        }\n\n        function bindKeyboardEvents () {\n          if (options.keyboard) {\n            modalElement.on('keyup', $modal.$onKeyUp);\n            modalElement.on('keydown', $modal.$onKeyDown);\n          }\n        }\n\n        function unbindKeyboardEvents () {\n          if (options.keyboard) {\n            modalElement.off('keyup', $modal.$onKeyUp);\n            modalElement.off('keydown', $modal.$onKeyDown);\n          }\n        }\n\n        // Private helpers\n\n        function hideOnBackdropClick (evt) {\n          if (evt.target !== evt.currentTarget) return;\n          if (options.backdrop === 'static') {\n            $modal.focus();\n          } else {\n            $modal.hide();\n          }\n        }\n\n        function preventEventDefault (evt) {\n          evt.preventDefault();\n        }\n\n        function destroyModalElement () {\n          if ($modal.$isShown && modalElement !== null) {\n            // un-bind events\n            unbindBackdropEvents();\n            unbindKeyboardEvents();\n          }\n\n          if (modalScope) {\n            modalScope.$destroy();\n            modalScope = null;\n          }\n\n          if (modalElement) {\n            modalElement.remove();\n            modalElement = $modal.$element = null;\n          }\n        }\n\n        return $modal;\n\n      }\n\n      // Helper functions\n\n      function safeDigest (scope) {\n        /* eslint-disable no-unused-expressions */\n        scope.$$phase || (scope.$root && scope.$root.$$phase) || scope.$digest();\n        /* eslint-enable no-unused-expressions */\n      }\n\n      function findElement (query, element) {\n        return angular.element((element || document).querySelectorAll(query));\n      }\n\n      return ModalFactory;\n\n    };\n\n  })\n\n  .directive('bsModal', function ($window, $sce, $parse, $modal) {\n\n    return {\n      restrict: 'EAC',\n      scope: true,\n      link: function postLink (scope, element, attr, transclusion) {\n\n        // Directive options\n        var options = {scope: scope, element: element, show: false};\n        angular.forEach(['template', 'templateUrl', 'controller', 'controllerAs', 'contentTemplate', 'placement', 'backdrop', 'keyboard', 'html', 'container', 'animation', 'backdropAnimation', 'id', 'prefixEvent', 'prefixClass', 'customClass', 'modalClass', 'size', 'zIndex'], function (key) {\n          if (angular.isDefined(attr[key])) options[key] = attr[key];\n        });\n\n        // Options: alias modalClass to customClass\n        if (options.modalClass) {\n          options.customClass = options.modalClass;\n        }\n\n        // use string regex match boolean attr falsy values, leave truthy values be\n        var falseValueRegExp = /^(false|0|)$/i;\n        angular.forEach(['backdrop', 'keyboard', 'html', 'container'], function (key) {\n          if (angular.isDefined(attr[key]) && falseValueRegExp.test(attr[key])) options[key] = false;\n        });\n\n        // bind functions from the attrs to the show and hide events\n        angular.forEach(['onBeforeShow', 'onShow', 'onBeforeHide', 'onHide'], function (key) {\n          var bsKey = 'bs' + key.charAt(0).toUpperCase() + key.slice(1);\n          if (angular.isDefined(attr[bsKey])) {\n            options[key] = scope.$eval(attr[bsKey]);\n          }\n        });\n\n        // Support scope as data-attrs\n        angular.forEach(['title', 'content'], function (key) {\n          if (attr[key]) {\n            attr.$observe(key, function (newValue, oldValue) {\n              scope[key] = $sce.trustAsHtml(newValue);\n            });\n          }\n        });\n\n        // Support scope as an object\n        if (attr.bsModal) {\n          scope.$watch(attr.bsModal, function (newValue, oldValue) {\n            if (angular.isObject(newValue)) {\n              angular.extend(scope, newValue);\n            } else {\n              scope.content = newValue;\n            }\n          }, true);\n        }\n\n        // Initialize modal\n        var modal = $modal(options);\n\n        if (options.keyboard) {\n          modal.returnFocus = function () {\n            element[0].focus();\n          };\n        }\n\n        // Trigger\n        element.on(attr.trigger || 'click', modal.toggle);\n\n        // Garbage collection\n        scope.$on('$destroy', function () {\n          if (modal) modal.destroy();\n          options = null;\n          modal = null;\n        });\n\n      }\n    };\n\n  });\n"]}